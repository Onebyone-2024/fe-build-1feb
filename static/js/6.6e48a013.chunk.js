(this["webpackJsonp@coreui/coreui-pro-react-admin-template"]=this["webpackJsonp@coreui/coreui-pro-react-admin-template"]||[]).push([[6],{548:function(e,t,a){},552:function(e,t,a){"use strict";var n=a(0),l=a.n(n),s=a(544);a(548);var o=a(44),i=a(16);t.a=e=>{let{refresh:t,status:a,icon:d,statusDisplay:r=!1,title:u="",cancelButtonTitle:c="Cancel",actionButtonTitle:m="Submit",cancelButtonClass:p="bg-background",actionButtonClass:f="bg-background",actionButtonEvent:h=null,colorText:g="red",msg1:b=null,msg2:w=null,onCloseFunction:v=null,refreshOnCancel:y=!0,setIsSuccess:S}=e;const F=Object(o.c)();500===(null===a||void 0===a?void 0:a.code)&&(d="em-pensive",u="Server Error",c="Try Again",m="Contact Administration",g="red",b=null===a||void 0===a?void 0:a.message,w="Please try again or contact Sayurbox administration for further information.",p="bg-green",r=!0,y=!0),408===(null===a||void 0===a?void 0:a.code)&&(d="em-alarm_clock",u="Request Timeout",c="Try Again",m="Contact Administration",g="red",b=null===a||void 0===a?void 0:a.message,w="Please try again or contact Sayurbox administration for further information.",p="bg-green",r=!0,y=!0),400===(null===a||void 0===a?void 0:a.code)&&(d="em-alarm_clock",u="Server Error",c="Try Again",m="Contact Administration",g="red",b=null===a||void 0===a?void 0:a.message,w="Please try again or contact Sayurbox administration for further information.",p="bg-green",r=!0,y=!1),404===(null===a||void 0===a?void 0:a.code)&&(u="Something wrong with the application",c="Try Again",m="Contact Administration",g="red",b=null===a||void 0===a?void 0:a.message,w="Please try again or contact Sayurbox administration for further information.",p="bg-green",r=!0,y=!1);const[E,C]=Object(n.useState)(r);return Object(n.useEffect)(()=>{C(r)},[r]),Object(n.useEffect)(()=>{},[E]),window.onkeydown=e=>27===e.keyCode?C(!1):null,l.a.createElement(s.B,{className:"".concat(E?null:"d-none")},l.a.createElement(s.f,null,l.a.createElement(s.s,{show:E,closeOnBackdrop:!1,onClose:()=>{C(!1),"function"===typeof S&&S({success:null,name:null}),F({type:i.k,status:null}),v&&v()},size:"lg",style:{minHeight:"280px"},bodyOpenClassName:"p-3"},l.a.createElement("div",{className:"d-flex flex-row-reverse"},l.a.createElement("i",{className:"pr-3 pt-3 iconU-modalClose",onClick:()=>{C(!1),"function"===typeof S&&S({success:null,name:null}),F({type:i.k,status:null}),v&&v()}})),l.a.createElement(s.v,{className:"px-5 pt-5 border-none"},l.a.createElement(s.w,{className:"text LatoBold ".concat(g)},u," ",l.a.createElement("span",null,l.a.createElement("i",{className:"em ".concat(d)})))),l.a.createElement(s.t,{className:"px-5 py-0"},l.a.createElement("p",{className:"text mb-2"},b),l.a.createElement("p",{className:"text"},w)),l.a.createElement(s.u,{className:"px-5 pb-5 pt-0 justify-content-start border-none"},c?l.a.createElement(s.d,{className:"".concat(p," no-shadow px-5 mt-4 mb-0 mx-0"),onClick:()=>{y?"function"===typeof t?t():(e=>{let{refresh:t=!0}=e;!0===t&&window.location.reload(!1)})({refresh:!0}):(e=>{let{setShow:t,parentOncCloseFunction:a}=e;t(!1),a&&a()})({setShow:C,parentOncCloseFunction:v}),F({type:i.k,status:null})}},c):null,m?l.a.createElement(s.d,{className:"".concat(f," text no-shadow px-5 mt-4 mb-0 ml-3 mr-0"),onClick:()=>{h?(h(),C(!1)):C(!1)}},m):null," "))))}},632:function(e,t,a){"use strict";var n=a(0),l=a.n(n),s=a(44),o=a(873),i=(a(941),a(791)),d=a.n(i),r=a(799),u=a(16);const c=()=>{document.getElementById("download-template-xls").click()};var m=a(731),p=a(552),f=a(549),h=a(559);const g={flex:1,display:"flex",flexDirection:"column",alignItems:"center",paddingTop:"20px",paddingBottom:"20px",paddingLeft:"20px",paddingRight:"20px",outline:"none",transition:"border .24s ease-in-out",height:"400px"},b={paddingTop:"20px",paddingBottom:"10px",paddingLeft:"20px",paddingRight:"20px",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fff",outline:"none",transition:"border .24s ease-in-out",height:"600px"},w={borderColor:"#2196f3"},v={borderColor:"#00e676"},y={borderColor:"#ff1744"};t.a=e=>{let{field:t,transaction:a,nextPage:i=null,type:S=null}=e;const[F,E]=l.a.useState(!1),[C,x]=l.a.useState(),[N,k]=l.a.useState(0),[O,U]=l.a.useState(null),[D,T]=l.a.useState(null),[j,I]=l.a.useState(null),[P,A]=l.a.useState(null),[B,R]=l.a.useState(null),[G,V]=l.a.useState(null),[W,_]=l.a.useState(!1),[K,L]=l.a.useState(!1),[M,H]=l.a.useState(!1),[X,z]=l.a.useState(!1),J=Object(s.c)(),q=Object(s.d)(e=>e.warehouseAreaCsv),Y=Object(s.d)(e=>e.outboundTypeCsv),Q=Object(s.d)(e=>e.status),Z=Object(s.d)(e=>e.csvDistinctPOSKUInfoId),$=Object(s.d)(e=>e.csvDistinctSKUNumber),ee=Object(s.d)(e=>e.skuCodeValidated),te=Object(s.d)(e=>e.skuNumberValidated),ae=Object(s.d)(e=>e.csvData),ne=Object(s.d)(e=>e.warehouseData);!0!==W&&(async e=>{let{dispatch:t,resetStatus:a,setIsResetCsvPersist:n}=e;t({type:u.l,csvData:null}),t({type:u.l,csvFileName:null}),t({type:u.l,csvDistinctPOSKUInfoId:null}),t({type:u.n,skuCodeValidated:null}),t({type:u.n,skuCodeValidated:null}),t({type:u.k,status:null}),n(!0)})({dispatch:J,resetStatus:W,setIsResetCsvPersist:_});const le=Object(s.d)(e=>e.user.warehouseUuid);null===D&&(Object(h.h)({warehouseUuid:le,dispatch:J,type:"csvValidator"}),T(1)),null===j&&"additionalOutbound"==S&&(Object(h.d)({dispatch:J,type:"csvValidator"}),I(1));const{getRootProps:se,getInputProps:oe,isDragActive:ie,isDragAccept:de,isDragReject:re,open:ue}=Object(o.a)({noClick:!0,onDropAccepted:async e=>{k(0),A(!0);const a=e[0].name;a.split(".")[1];let n=t.map(e=>e.dataField);(e=>{let{dispatch:t,jsonArray:a}=e;t({type:u.l,csvField:a})})({dispatch:J,jsonArray:t});let l=null;if(await x("Reading..."),await U(a),await E(!0),l=await(async(e,t,a,n,l)=>{let s=0,o=[];const i=new FileReader;let u=null;return new Promise((n,l)=>{i.onload=async e=>{const l=e.target.result,i=r.read(l,{type:"binary"}),c=i.SheetNames[0],m=i.Sheets[c];u=r.utils.sheet_to_csv(m,{header:1}),await d.a.parse(u,(e,l)=>{l.length>2001&&(a(0),n(!1)),l.map((e,n)=>{let i={};i.id=n;let d=[],r=null;if(0===s)d=l[s].map((e,t)=>e.includes(",")?'"'.concat(e,'"'):"".concat(e)),r=d.toString().split(",");else{d=l[s].map((e,t)=>{let a=null;return a=e.includes(",")?'"'.concat(e,'"'):0===t?"".concat(e,'"'):t===l[s].length-1?'"'.concat(e):'"'.concat(e,'"'),a}),r=d.toString().split('","')}r.map((e,a)=>{i[t[a+1]]=e}),s++,o.push(i);let u=25*(n+1)/l.length;a(Math.ceil(u))})}),setTimeout(()=>{n(o)},200)},i.readAsBinaryString(e[0])})})(e,n,k),!1===l)return L(!0),0;await x("Validating Column Type..."),await(async e=>{let{field:t,jsonArray:a,setIsProgressPercent:n,fileName:l,dispatch:s,warehouseArea:o,warehouseUuid:i,outboundType:d,setIsCheckingSchema:r,setIsCheckingArea:c,warehousesData:m}=e,p=[],f=[],h=[];m&&m.data.map(e=>{p.push(e.code),f.push(e.id),h.push(e.name)});let g=o?o.map(e=>e.label.toUpperCase()):[],b=o?o.map(e=>e.value):[],w=d?d.map(e=>e.label.toUpperCase()):[],v=d?d.map(e=>e.value):[],y=t?t.map(e=>e.text.toUpperCase().replace(/\s/g,"")):[],S=[],F=[],E=[],C=[],x=!0,N=0;const k=a[0];for(var O in k){if("id"==O)continue;let e=k[O].toUpperCase().replace(/\s/g,"");if("undefined"!==O&&(y[N+1]!==e||!y.includes(e)))return console.clear(),console.log("--Schema Not Same--"),console.log("Schema \t\t: ",y[N+1]),console.log("File SChema : ",e),x=!1,r(!1),0;N++}if(a.shift(),await a.map((e,l)=>{let s=!0;t.map((t,o)=>{if(void 0===t||null===t)return;if("id"!==t.dataField&&""==e[t.dataField])return;if("id"!==t.dataField&&(s=!1),e.warehouseSource=i,p&&"warehouse"==t.dataField){if(!p.includes(e[t.dataField]))return e[t.dataField+"Status"]=!1,e[t.dataField+"Reason"]="Warehouse Not Found",e.warehouseUuid="",void(e.warehouseName="");{let a=p.indexOf(e[t.dataField]);e.warehouseUuid=f[a],e.warehouseName=h[a]}}if(p&&"warehouseDestination"==t.dataField){if(!p.includes(e[t.dataField]))return e[t.dataField+"Status"]=!1,e[t.dataField+"Reason"]="Warehouse Not Found",e.warehouseDestinationUuid="",void(e.warehouseDestinationName="");{let a=p.indexOf(e[t.dataField]);e.warehouseDestinationUuid=f[a],e.warehouseDestinationName=h[a]}}if("areaName"==t.dataField){if(!g.includes(e[t.dataField].toUpperCase()))return e[t.dataField+"Status"]=!1,e[t.dataField+"Reason"]="Warehouse Area Not Found",void(e.areaSource=null);{let a=g.indexOf(e[t.dataField].toUpperCase());e.areaSource=b[a],E.includes(b[a])||E.push(b[a])}}if("areaNameDestination"==t.dataField){if(!g.includes(e[t.dataField].toUpperCase()))return e[t.dataField+"Status"]=!1,e[t.dataField+"Reason"]="Warehouse Area Not Found",void(e.areaDestination=null);{let a=g.indexOf(e[t.dataField].toUpperCase());e.areaDestination=b[a],C.includes(b[a])||C.push(b[a])}}if(v.length>0&&"outboundType"==t.dataField){if(!w.includes(e[t.dataField].toUpperCase()))return e[t.dataField+"Status"]=!1,e[t.dataField+"Reason"]="Outbound Type Not Found",void(e.outboundTypeCode=null);{let a=w.indexOf(e[t.dataField].toUpperCase());e.outboundTypeCode=v[a]}}if("newGrade"==t.dataField){let a=["WASTE","SEMI WASTE",""];e[t.dataField]&&!a.includes(e[t.dataField].toUpperCase())?parseInt(e[t.dataField])?(F.includes(e[t.dataField])||F.push(e[t.dataField]),e[t.dataField+"Status"]=!0):""==e[t.dataField]?e[t.dataField+"Status"]=!0:(e[t.dataField+"Status"]=!1,e[t.dataField+"Reason"]="Grade Undefined"):e.newGradeUuid=e[t.dataField]}let d=null;if(("ripenessLevel"==t.dataField||"newRipeness"==t.dataField)&&void 0!==e[t.dataField]){d=e[t.dataField].split(" ")[1]}let r=e[t.dataField],u=null;if("number"==t.type)isNaN(r)?u=!1:(u=!0,"wmsPoSkuCode"==t.dataField&&(S.includes(r)||S.push(r)),"skuNumber"==t.dataField&&(F.includes(r)||""===r||F.push(r)));else if("date_indo"==t.type){let a=/(0[1-9]|[12][0-9]|3[01])[-.](0[1-9]|1[012])[-.](19|20)\d\d/;if(!r.match(a))return e[t.dataField+"Status"]=!1,void(e[t.dataField+"Reason"]="Date format must be 'dd-mm-yyyy'");u=!0}else u=!0;if(["grade","outboundReason","ripenessLevel","newRipeness","newGrade"].includes(t.dataField)&&""==r&&(u=!0),"newGrade"==t.dataField){["WASTE","SEMI WASTE",""].includes(r.toUpperCase())||parseInt(r)&&(u=!0,F.includes(r)||""===r||F.push(r))}e[t.dataField+"Status"]=u,e[t.dataField+"Reason"]=u?"":"Invalid ".concat(t.text," \nShould be a ").concat(t.type);let c=50*(l+1+parseInt(a.length))/(2*parseInt(a.length));n(Math.ceil(c))}),e.emptyRow=s}),E.length>1||C.length>1)return console.log("area Destination :"+C),console.log("area Source :"+E),void c(!1);s({type:u.l,csvData:a}),s({type:u.l,csvFileName:l}),s({type:u.l,csvDistinctPOSKUInfoId:S}),s({type:u.l,csvDistinctSKUNumber:F})})({field:t,jsonArray:l,setIsProgressPercent:k,fileName:a,dispatch:J,warehouseArea:q,warehouseUuid:le,outboundType:Y,setIsCheckingSchema:R,warehousesData:ne,setIsCheckingArea:V}),await x("Validating PO SKU Code. . .")},accept:"text/csv,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ce=Object(n.useMemo)(()=>({...g,...ie?w:{},...de?v:{},...re?y:{}}),[ie,re,de]);return Object(n.useEffect)(()=>{Object(f.w)({dispatch:J,skuData:Z,status:P})},[Z]),Object(n.useEffect)(()=>{k(70),x("Validating SKU Numbers"),Object(f.y)({dispatch:J,skuNumberData:$,bulk:!0,status:P})},[ee]),Object(n.useEffect)(()=>{k(90),x("rearrange data. . ."),(async e=>{let{poSkuInfoValidated:t,poSkuNumberValidated:a,csvData:n,setIsProgressPercent:l,dispatch:s,status:o,transaction:i,setIsProgressStatus:d,nextPage:r}=e;if(!1===o||null===o)return 0;if(void 0===n||null===n||null===t||void 0===t||null===a||void 0===a)return console.clear(),0;const c=[],m=[];t.map(e=>{c.push(e.wmsPoSkuCode),m.push(e.uom)});let p=[],f=[],h=[],g=[];a.map(e=>{p.push(e.skuNumber),f.push(e.id),h.push(e.imageMd),g.push(e.uom)});let b=[];n.map((e,a)=>{if(!0===e.emptyRow)return 0;e.areaSource=parseInt(e.areaSource),e.areaDestination=parseInt(e.areaDestination),"stock_take"!=i&&"repacking"!=i&&"outbound"!=i||(e.areaDestination=parseInt(e.areaSource),e.warehouseDestination=parseInt(e.warehouseSource));let n=c.indexOf(e.wmsPoSkuCode),l=t[n];"additional_inbound"!==i&&(l&&void 0!==l.isExist&&!1!==l.isExist&&null!==l.isExist?(e.inboundDate=l.inboundDate,e.uom=m[n]):(e.wmsPoSkuCodeStatus=!1,e.wmsPoSkuCodeReason="PO SKU Code Not Found"));let s=e.newGrade,o=["WASTE","SEMI WASTE",""];if(void 0!==s&&!o.includes(s.toUpperCase()))if(p.includes(s)){let t=p.indexOf(s);e.newGradeStatus=!0,e.newGradeUuid=f[t]}else""==s?(e.newGradeUuid="",e.newGradeStatus=!0):(e.newGradeReason="Grade Undefined",e.newGradeStatus=!1);let d=e.skuNumber;if(p.includes(d)){let t=p.indexOf(d);e.skuUuid=f[t],e.photo=h[t],"additional_inbound"==i&&(e.uom=g[t])}else e.skuNumberStatus=!1,e.skuNumberReason="SKU Number Not Found",e.skuUuid="";let r=e.newGrade;if(console.log("tmp_new_grade",r),"additional_inbound"!==i)if(r&&o.includes(r.toUpperCase())||""==r)e.newGradeReason="",e.newGradeStatus=!0,e.newGradeUuid=null,e.newGradeUom=null;else if(p.includes(r)){let t=p.indexOf(r);e.newGradeReason="",e.newGradeStatus=!0,e.newGradeUuid=f[t],e.newGradeUom=g[t]}else e.newGradeReason="SKU Number Not Found",e.newGradeStatus=!1,e.newGradeUuid=null,e.newGradeUom=null;b.push({...e,...l})}),s({type:u.l,csvData:b}),l(Math.ceil(100)),setTimeout(()=>{r()},200)})({poSkuInfoValidated:ee,poSkuNumberValidated:te,csvData:ae,transaction:a,setIsProgressPercent:k,dispatch:J,status:P,setIsProgressStatus:x,nextPage:i})},[te]),Object(n.useEffect)(()=>{!1===B&&(console.log(B),H(!0),R(null))},[B]),Object(n.useEffect)(()=>{!1===G&&(console.log(G),z(!0),V(null))},[G]),l.a.createElement("div",null,l.a.createElement(p.a,{status:Q,onCloseFunction:()=>{L(!1),k(0),E(!1)},statusDisplay:K,title:"Upload File Failed",cancelButtonTitle:"Try Another File",actionButtonTitle:null,colorText:"red",refreshOnCancel:!1,msg1:l.a.createElement("div",null,l.a.createElement("div",null,"Upload failed because your file has more than 2000 lines."," "),l.a.createElement("div",null," Please make it less than 2000 lines. ")),msg2:"Do you want to try another file?",cancelButtonClass:"bg-red background",actionButtonClass:" "}),l.a.createElement(p.a,{status:200,onCloseFunction:()=>{H(!1),k(0),E(!1)},actionButtonEvent:()=>c(),statusDisplay:M,title:"Different File Template",cancelButtonTitle:"Cancel",actionButtonTitle:"Download latest template",colorText:"red",refreshOnCancel:!1,msg1:l.a.createElement("div",null,l.a.createElement("div",null," Your uploaded file has a different template.")),msg2:"Do you want to download the latest file template ?",actionButtonClass:"bg-green background",cancelButtonClass:""}),l.a.createElement(p.a,{status:200,onCloseFunction:()=>{z(!1),k(0),E(!1)},actionButtonEvent:()=>{z(!1),k(0),E(!1)},statusDisplay:X,title:"Upload File Failed!",actionButtonTitle:"Try Another File",colorText:"red",refreshOnCancel:!1,msg1:l.a.createElement("div",null,l.a.createElement("div",null," ","We detect that you've uploaded two or more areas at once."),l.a.createElement("div",null," ","Please try again to upload the file with one specific area.")),msg2:"Do you want to try another file ?",actionButtonClass:"bg-red margin-left-0 background",cancelButtonClass:"d-none "}),l.a.createElement("div",{className:"w-100 d-flex flex-column p-3 mb-3 bg-white"},l.a.createElement("div",{className:"d-flex flex-column justify-content-between",style:b},l.a.createElement("div",{className:"FileUploader"},l.a.createElement("div",Object.assign({className:"d-flex flex-column justify-content-end"},se({style:ce})),l.a.createElement("input",oe()),l.a.createElement("i",{style:{fontSize:"90px"},className:"lineGrey iconU-upload"}),l.a.createElement("b",{className:"mt-2"},"Drag and Drop files here"),l.a.createElement("p",{className:"mt-2 mb-2 emptyTextField"}," Or "),l.a.createElement("button",{type:"button",onClick:ue,className:"btn px-5 py-2 text-white bg-green LatoBold no-shadow"},"Browse File"),l.a.createElement("div",{className:"emptyTextField LatoBold mt-3 "},"Support only CSV, XLS, XLSX file"))),l.a.createElement("div",{className:"downloadTemplate w-100 align-right"},l.a.createElement("span",{onClick:()=>c(),className:"float-right"},"Download the File Template")))),l.a.createElement(m.a,{status:C,progressPercent:N,fileName:O,display:F,cancelHandler:()=>{window.location.reload()}}))}},730:function(e,t){},731:function(e,t,a){"use strict";var n=a(0),l=a.n(n);a(732);t.a=e=>{let{status:t,progressPercent:a,fileName:s,display:o=!1,cancelButton:i=null,cancelHandler:d}=e;return Object(n.useEffect)(()=>{},[a,t]),l.a.createElement("div",{className:"w-100 d-flex flex-column progressBar "+(o?null:"hiddenProgress")},l.a.createElement("div",{className:"pt-3 pb-0 pl-3 pr-3 bg-white border-all radius-all mb-3 mt-0"},l.a.createElement("div",{className:"d-md-flex d-lg-flex mb-3 justify-content-between"},l.a.createElement("div",{className:"uploadStatus w-100"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-7"},l.a.createElement("i",{className:"iconU-sideBarInventoryEntry green"})," File",s),l.a.createElement("div",{className:"col-md-5"},l.a.createElement("p",{className:"float-right",style:{lineHeight:"30px",cursor:"pointer"},onClick:()=>{d()}},"Cancel"))),l.a.createElement("div",{class:"progress"},l.a.createElement("div",{class:"progress-bar",role:"progressbar",style:{width:a+"%"},"aria-valuemin":"0","aria-valuemax":"100"})),l.a.createElement("div",{className:"mt-2"},l.a.createElement("div",{className:"emptyTextField inline"},t),l.a.createElement("div",{className:"text inline font-weight-bold"},"  ",a,"%"))))))}},732:function(e,t,a){},794:function(e,t){},795:function(e,t){},801:function(e,t){},802:function(e,t){},941:function(e,t,a){}}]);
//# sourceMappingURL=6.6e48a013.chunk.js.map