(this["webpackJsonp@coreui/coreui-pro-react-admin-template"]=this["webpackJsonp@coreui/coreui-pro-react-admin-template"]||[]).push([[52],{1187:function(e,t,a){"use strict";a.r(t);var s=a(0),o=a.n(s),n=a(44),l=a(12),i=a(581),u=a(567),r=(a(631),a(16)),d=a(549),c=a(14),m=a.n(c);const p=async e=>{let{csvData:t,dispatch:a,csvField:s,setIsSubmitText:o,setSubmitStatus:n,setIsShowModal:l,setMsg2:i}=e;console.log(t),o("Loading...");let u=await(e=>{let t=(new Date).getTime(),a=new Date(t).getMilliseconds(),s=[],o=[],n=e[0].warehouseUuid||"",l=e[0].warehouseDestinationUuid||"";return e.map((e,t)=>{s.includes(e.areaSource)||(o.push({id:t,warehouseSource:n,warehouseDestination:l,areaSource:e.areaSource,areaDestination:e.areaSource,list:[],createdAt:a}),s.push(e.areaSource))}),o})(t),c=t[0].warehouseName||"Warehouse",p=t[0].areaName||"Area",h=t[0].warehouseDestinationName||"Warehouse Destination",v=await(e=>{let t=[],a=e[0].warehouseUuid||"",s=e[0].warehouseDestinationUuid||"";return e.map((e,o)=>{let n=!1;t.forEach((t,a)=>{t&&t.skuUuid==e.skuUuid&&t.warehouseSource==e.warehouseSource&&t.warehouseDestination==e.warehouseDestinationUuid&&t.areaSource==e.areaSource&&(n=!0)}),n||t.push({warehouseSource:a,warehouseDestination:s,areaSource:e.areaSource,skuUuid:e.skuUuid,skuNumber:e.skuNumber,unitOfMeassures:e.uom,photo:e.photos,poList:[]})}),t})(t),b=await((e,t)=>{let a=[],s=e[0].warehouseUuid||"",o=e[0].warehouseDestinationUuid||"";return e.map((e,t)=>{let n=!1,l="";console.log(e);let i=(e=>{if(e)return"SEMI WASTE"==e.toUpperCase()?"semi_waste":"WASTE"==e.toUpperCase()?"waste":e})(e.newGradeUuid);i||(i=e.skuUuid),a.forEach((t,a)=>{t&&t.areaSource==e.areaSource&&t.warehouseSource==e.warehouseSource&&t.warehouseDestination==e.warehouseDestination&&t.skuUuid==e.skuUuid&&t.wmsPoSkuCode==e.wmsPoSkuCode&&t.ripenessLevel==e.ripenessLevel&&t.expiryDateCol==e.expiryDateCol&&(n=!0,l=a)}),n||(a.push({skuUuid:e.skuUuid||"",areaSource:e.areaSource||"",warehouseSource:s||"",warehouseDestination:o||"",expiryDateText:e.expiryDateCol||"",expiryDate:m()(e.expiryDateCol,"DD-MM-YYYY").toDate().getTime()||"",inboundDate:e.inboundDate||"",supplierId:e.supplierUuid||"",supplierName:e.supplierName||"",wmsPoSkuCode:e.wmsPoSkuCode||"",codeGrade:e.skuUuid||"",ripenessLevel:e.ripenessLevel||0,skuNumber:e.skuNumber||"",areaName:e.areaName||"",warehouseCode:e.warehouseCode||"",itemList:[]}),l=a.length-1),a[l].itemList.push({qty:e.qty||0,areaSource:e.areaSource,skuNumber:e.skuNumber,ripeness:{label:e.ripenessLevel||"",value:e.ripenessLevel||0},expiryDate:m()(e.expiryDateCol,"DD-MM-YYYY").toDate().getTime()||"",expiryDateText:e.expiryDateCol,grade:{label:e.newGrade,value:i||e.skuUuid},codeOutbound:{label:e.outboundTypeCode||"",value:e.outboundTypeCode||""},note:e.reason||"",areaName:e.areaName||"",pack:e.inputPack||0,unitOfMeassures:e.uom||"",warehouseCodeSource:e.warehouse||"",warehouseCodeDestination:e.warehouseDestination||""})}),a})(t),w=await((e,t,a)=>(t.map((e,s)=>{a.map((a,o)=>{a&&a.areaSource==e.areaSource&&a.warehouseSource==e.warehouseSource&&a.warehouseDestination==e.warehouseDestination&&a.skuUuid==e.skuUuid&&t[s].poList.push(a)})}),e.map((s,o)=>{t.map((t,n)=>{a&&s.areaSource==t.areaSource&&s.warehouseSource==t.warehouseSource&&s.warehouseDestination==t.warehouseDestination&&e[o].list.push(t)})}),e))(u,v,b),y=await Object(d.s)({dataCsv:w,setSubmitStatus:n,dispatch:a,transaction:"stock-transfer"});var S;if(l(!1),o("Submit"),!0===(null===y||void 0===y?void 0:y.isSuccess))i([{className:"h5 font-weight-bold",message:"PO Number: ".concat(null===y||void 0===y||null===(S=y.data)||void 0===S?void 0:S.poNumber)},{className:"h5 green mt-4",message:"".concat(c," (").concat(p,") to ").concat(h," - ").concat((null===v||void 0===v?void 0:v.length)||0," SKU(s).")}]),n("success");else if(!1===(null===y||void 0===y?void 0:y.isSuccess)&&(null===y||void 0===y?void 0:y.jobPost)){i([{className:"h5 font-weight-bold",message:"Failed to proceed because we can't match some of data."},{className:"h5 green mt-3",message:"Try to fix the error part and try again."}]),n("noData");let e=await(e=>{let t=[],a=1;return e.list.map((e,s)=>{e.poList.map((e,s)=>{e.itemList.map((s,o)=>{var n;let l="Failed";s.isSuccess&&(l="Success"),t.push({id:a,uploadStatus:l||"",uploadStatusReason:s.message,wmsPoSkuCode:e.wmsPoSkuCode||"",skuNumber:s.skuNumber||"",ripenessLevel:(null===(n=s.ripeness)||void 0===n?void 0:n.label)||"",qty:s.qty||0,reason:s.note||"",grade:e.codeGrade||"",areaName:s.areaName||"",warehouse:s.warehouseCodeSource||"",areaNameDestination:s.areaNameDestination||"",warehouseDestination:s.warehouseCodeDestination||"",expiryDateCol:s.expiryDateText||""}),a++})})}),t})((null===y||void 0===y?void 0:y.jobPost)||[]);await a({type:r.l,csvDataResult:e});let t=[];t.push({dataField:"uploadStatus",text:"Upload Status",type:"string",sort:!0}),s.map((e,a)=>{t.push(e)}),await a({type:r.l,csvFieldResult:t})}else setTimeout(()=>{console.log(y)},3e3),i(((null===y||void 0===y?void 0:y.status)?"".concat(null===y||void 0===y?void 0:y.status,"  - "):"")+"Failed to proceed."),n("API")};var h=a(544);a(548);var v=e=>{let{isSaved:t,setIsSaved:a,confirmation:s,submit:n,statusDisplay:l=!1,title:i="",cancelButtonTitle:u="Cancel",actionButtonTitle:r="Submit",cancelButtonClass:d="bg-background",actionButtonClass:c="bg-background",actionButtonEvent:m=null,msg1:p=null,msg2:v=null,setShow:b,onCloseFunction:w}=e;const y={success:{headerIcon:"em em-tada",textColor:"green",button:"bg-green"},failed:{headerIcon:"em em-anguished",textColor:"red",button:"bg-red"}},S="success"==t?y.success:y.failed,g=document.getElementById("btn_is_saved");return g&&g.focus(),o.a.createElement(h.B,{className:l?null:"d-none"},o.a.createElement(h.f,null,o.a.createElement(h.s,{show:l,onClose:()=>{w()},size:"lg",style:{minHeight:"280px"},bodyOpenClassName:"p-3",closeOnBackdrop:!1},o.a.createElement("div",{className:"d-flex flex-row-reverse"},o.a.createElement("i",{className:"pr-3 pt-3 iconU-modalClose",onClick:()=>{w()}})),o.a.createElement(h.t,{className:"px-5 mt-3 py-0"},o.a.createElement("label",{className:"".concat(S.textColor," LatoBold mr-2 h5 mb-3")},i)," ",o.a.createElement("span",null,o.a.createElement("i",{className:"".concat(S.headerIcon)})),o.a.createElement("div",{className:"mr-1 h5 mb-3"},"".concat(p)),o.a.createElement("div",{style:{backgroundColor:"#F5F7FA"},className:"w-100 border rounded px-3 pt-4 pb-3 mb-4"},Array.isArray(v)?v.map((e,t)=>o.a.createElement("div",{className:e.className}," ",e.message," ")):o.a.createElement("div",{className:"h5 font-weight-bold"},v))),o.a.createElement(h.u,{className:"px-5 pb-5 pt-0 justify-content-start border-none"},u?o.a.createElement(h.d,{className:"".concat(d," no-shadow px-5 mt-4 mb-0 mx-0"),onClick:()=>{w()}},u):null,r?o.a.createElement(h.d,{className:"".concat(c," text no-shadow px-5 mt-4 mb-0 ml-3 mr-0"),onClick:()=>{m()}},r):null," "))))};t.default=Object(l.i)(e=>{const t=Object(n.c)(),a=Object(n.d)(e=>e.csvFileName),l=Object(n.d)(e=>e.csvData),d=Object(n.d)(e=>e.csvField),c=Object(n.d)(e=>e.warehouseAreaCsv),m=Object(n.d)(e=>e.status),h=Object(n.d)(e=>e.warehouseData),[b,w]=o.a.useState(!1),[y,S]=o.a.useState(null),[g,k]=o.a.useState(!0),[N,f]=o.a.useState(!1),[E,C]=o.a.useState(!1),[x,D]=o.a.useState(!0),[U,T]=o.a.useState(!1),[I,O]=o.a.useState(null),[F,L]=o.a.useState(null),[P,B]=o.a.useState(null),[R,A]=o.a.useState(null),[W,M]=o.a.useState(null),[j,K]=o.a.useState("Submit"),[V,q]=o.a.useState(null),[G,H]=o.a.useState(null),[Y,_]=o.a.useState(null);if(Object(s.useEffect)(()=>{(e=>{let{csvData:t,csvField:a,setIsValidate:s,setCheckingCsv:o}=e;if(void 0===t)return 0;let n=!0;t.map((e,t)=>{a.map((t,a)=>{let s=e[t.dataField+"Status"];if("outboundType"==t.dataField){"LAINNYA"==e[t.dataField].toUpperCase()&&""==e.outboundReason&&(s=!1)}!1===s&&(n=!1)})}),s(!1!==n),o(!1)})({csvData:l,csvField:d,setIsValidate:f,setCheckingCsv:D})},[x]),Object(s.useEffect)(()=>{"success"==U?(O("Success!"),L(a+" upload successfull."),A("Cancel"),M("Select Again"),H("bg-green background"),_("green"),C(!0)):"API"==U?(O("Failed!"),L(a+" failed to upload."),A("Cancel"),M("Retry"),H("bg-red background"),_("red"),C(!0)):"noData"==U&&(O("Failed!"),L(a+" failed to upload."),A("Check"),q("bg-red background"),H("d-none"),_("red"),C(!0))},[U]),void 0===l||null===l)return e.history.push("/inventory-entry/stock-transfer/CSV-upload"),0;const J=e=>{(e=>{let{param:t,dispatch:a,setCheckingCsv:s}=e;a({type:r.l,csvData:t}),s(!0)})({param:e,dispatch:t,setCheckingCsv:D})};return o.a.createElement("div",{className:"w-100 d-flex flex-column stock-take-summary"},o.a.createElement(i.a,{globalData:l,columns:d,tableClass:"reviewTable",hiddenRows:y,warehouseArea:c,setCsvDataTmp:e=>J(e),setIsValidate:e=>f(e),dispatch:t,setCheckingCsv:D,warehousesData:h,transaction:"stockTransfer"}),o.a.createElement("div",{className:"row pt-3"},o.a.createElement("div",{className:"col-4"},o.a.createElement("button",{type:"button",className:"btn px-3 mr-3 text no-shadow",style:{backgroundColor:"#fff"},onClick:()=>(e=>{let{csvData:t,csvField:a,isShowErrorOnly:s,setIsShowErrorOnly:o,setIsHiddenRows:n,setCheckingCsv:l}=e,i=[],u=[];t.map((e,t)=>{let s=!0,o=t+1;a.map((t,a)=>{let o=t.dataField+"Status";!1===e[o]&&(s=!1)}),!1===s?i.includes(o)||i.push(o):u.includes(o)||u.push(o)});let r=[];if(!0===s){if(r=u.filter(e=>!i.includes(e)),r.length==t.length)return 0}else r=[];n(r),o(!s),l(!0)})({csvData:l,csvField:d,isShowErrorOnly:g,setIsShowErrorOnly:k,setIsHiddenRows:S,setCheckingCsv:D})},"Show ",g?"Errors Only":"All"),o.a.createElement("button",{type:"button",className:"btn px-3 mr-3  text no-shadow",style:{backgroundColor:"#fff"},onClick:()=>(e=>{let{csvData:t,csvField:a,dispatch:s,setCheckingCsv:o}=e,n=[];t.map((e,t)=>{let s=!0;a.map((t,a)=>{let o=t.dataField+"Status";!1===e[o]&&(s=!1)}),!0===s&&n.push(e)}),s({type:r.l,csvData:n}),o(!0)})({csvData:l,csvField:d,dispatch:t,setCheckingCsv:D})},"Delete Errors Field")),o.a.createElement("div",{className:"col-4",style:{lineHeight:"40px"}},"Review your imported file: ",a," (",l.length||0," Lines)"),o.a.createElement("div",{className:"col-4"},o.a.createElement("button",{type:"button",className:"btn px-5 bg-red text-white no-shadow float-right",onClick:()=>e.history.goBack()},"Discard"),o.a.createElement("button",{type:"button",class:"btn px-5 mr-3 text-white no-shadow float-right "+(!0===N&&(null===l||void 0===l?void 0:l.length)>0?"bg-green":"bg-primaryGrey disabled"),onClick:()=>w(!b)},"Submit"))),o.a.createElement(v,{isSaved:U,status:m,onCloseFunction:()=>{C(!1),T(!1),"success"==U?e.history.push("/inventory-entry/stock-transfer"):"noData"==U&&e.history.push("/inventory-entry/stock-transfer/CSV-upload/result")},statusDisplay:E,title:I,cancelButtonTitle:R,actionButtonTitle:W,colorText:Y,refreshOnCancel:!1,msg1:F,msg2:P,cancelButtonClass:V,actionButtonClass:G+" ml-0",actionButtonEvent:()=>{("success"==U||"API"==U)&&e.history.push("/inventory-entry/stock-transfer/CSV-upload")}}),o.a.createElement(u.a,{submit:()=>p({dispatch:t,csvData:l,csvField:d,setIsShowModal:w,setIsSubmitText:K,setSubmitStatus:T,setMsg1:L,setMsg2:B}),submitText:j,show:b,setIsShowModal:w}))})},548:function(e,t,a){},551:function(e,t,a){},567:function(e,t,a){"use strict";a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return c}));var s=a(0),o=a.n(s),n=a(544),l=(a(551),a(44)),i=a(597);const u=e=>{let{e:t,state:a,isCaptcha:s,setIsValidated:o,setIsType:n,isType:l,isValidated:i,submit:u}=e;const r=t.key;let d=[...l];if("Enter"===r){if(!i)return;u()}if(["ArrowUp","ArrowDown","Tab","Delete"].includes(r))return 0;if("Backspace"===r){let e=[...l];""==e[a]&&1!==a&&(document.getElementById("t"+(parseInt(a)-1)).focus(),document.getElementById("t"+(parseInt(a)-1)).value="",e[a-1]="",d[a-1]="")}else if("ArrowLeft"===r){if(1!==a)return document.getElementById("t"+(parseInt(a)-1)).focus(),document.getElementById("t"+(parseInt(a)-1)).setSelectionRange(-1,-1),0}else if("ArrowRight"===r){if(3!==a)return document.getElementById("t"+(parseInt(a)+1)).focus(),document.getElementById("t"+(parseInt(a)+1)).setSelectionRange(-1,-1),0}else 3!==a&&document.getElementById("t"+(parseInt(a)+1)).focus();d[a]="Backspace"===r?"":r.toUpperCase();if(!"QWERTYUIOPLKJHGFDSAZXCVBNM1234567890".split("").includes(r.toUpperCase())&&""!=d[a])return 0;document.getElementById("t"+parseInt(a)).value=d[a],n(d);let c=!0;s.map((e,t)=>{d[t+1]!=s[t]&&(c=!1)}),o(c)};var r=a(547);const d=e=>{var t,a,l;let{moduleEntry:u,confirmation:d,setConfirmation:c,save:m,submit:p,isSuccess:h,isLoading:v,moveAll:b,setAction:w,moduleName:y,noSkuChecking:S,singleViewData:g}=e;const k=document.documentElement.clientHeight-300;let N="Submit";"save"===d.name&&(N="Save"),Object(s.useEffect)(()=>{h&&c({show:!1,name:null})},[h]),window.onkeydown=e=>27===e.keyCode?c({show:!1,name:null}):null,Object(s.useEffect)(()=>{w(d.name)},[d]);let f=g&&!b?g:u;const E=null===f||void 0===f||null===(t=f.jobPost)||void 0===t?void 0:t.areaDestinationName,C=null===f||void 0===f||null===(a=f.jobPost)||void 0===a?void 0:a.warehouseDestinationName,x=null===f||void 0===f||null===(l=f.jobPost)||void 0===l?void 0:l.areaName,D=((e,t,a)=>{if(null===e||void 0===e?void 0:e.length){let s=[];e.map(e=>{e.poList.map(o=>{o.itemList.map(o=>{var n,l,u,r,d,c;const{qty:m,grade:p}=o,h=Object(i.a)(m)?parseInt(m):m?parseFloat(m):0,v=t?e.skuName:"waste"===a?(null===(n=o.wasteType)||void 0===n?void 0:n.label)?null===(l=o.wasteType)||void 0===l?void 0:l.label:e.skuName:null===p||void 0===p?void 0:p.label,b="waste"===a?"Semi Waste"===(null===(u=o.wasteType)||void 0===u?void 0:u.label)||"Waste"===(null===(r=o.wasteType)||void 0===r?void 0:r.label):"Waste"===(null===p||void 0===p?void 0:p.label)||"Semi Waste"===(null===p||void 0===p?void 0:p.label),w=t?e.unitOfMeassures:"gram"===(null===p||void 0===p?void 0:p.uom)?"kg":null===p||void 0===p?void 0:p.uom;let y={sku:v,qty:h,uom:w,wqty:0,swqty:0};b&&(y.qty=0,y.sku=e.skuName),("waste"===a?"Waste"===(null===(d=o.wasteType)||void 0===d?void 0:d.label):"Waste"===(null===p||void 0===p?void 0:p.label))&&(y.wqty=h),("waste"===a?"Semi Waste"===(null===(c=o.wasteType)||void 0===c?void 0:c.label):"Semi Waste"===(null===p||void 0===p?void 0:p.label))&&(y.swqty=h);const S=s.findIndex(t=>(null===t||void 0===t?void 0:t.sku)===(b?e.skuName:v));var g,k;("waste"!==a&&(-1===S&&s.push(y),-1!==S&&(b||(s[S].qty+=h),"Semi Waste"===(null===p||void 0===p?void 0:p.label)&&(s[S].swqty+=h),"Waste"===(null===p||void 0===p?void 0:p.label)&&(s[S].wqty+=h))),"waste"===a)&&(-1===S&&s.push(y),-1!==S&&(b||(s[S].qty+=h),"Semi Waste"===(null===(g=o.wasteType)||void 0===g?void 0:g.label)&&(s[S].swqty+=h),"Waste"===(null===(k=o.wasteType)||void 0===k?void 0:k.label)&&(s[S].wqty+=h)))})})});const o=e.length?e[0].skuName:"No SKU",n=s.findIndex(e=>e.sku===o);return s.forEach(e=>{-1!==n&&("Waste"===e.sku&&(s[n].wqty=e.qty),"Semi Waste"===e.sku&&(s[n].swqty=e.qty))}),s}})(null===f||void 0===f?void 0:f.jobPost.list,S,y);return o.a.createElement(n.B,{className:"modalConfirmation "+(d.show?null:"d-none")},o.a.createElement(n.f,null,o.a.createElement(n.s,{show:d.show,closeOnBackdrop:!1},o.a.createElement(n.v,{className:"px-4 pt-5 border-none"},o.a.createElement(n.w,{className:"text LatoBold"},"Confirmation"," ",o.a.createElement("span",null,o.a.createElement("i",{className:"em em-pray"}))),o.a.createElement("label",{tabIndex:"0",onKeyDown:e=>13===e.keyCode&&c({show:!1,name:null}),onClick:()=>c({show:!1,name:null}),className:"sku-item iconU-modalClose"})),o.a.createElement(n.t,{className:"px-4 py-0",style:{minHeight:k}},o.a.createElement("p",{className:"text mb-2"},o.a.createElement("span",null,"Are you sure want to ".concat("Waste"==x?"update":"send"," this Item ")),o.a.createElement("span",{className:" ".concat(E?null:"d-none")}," from"),o.a.createElement("span",{className:"green ".concat(E?null:"d-none")}," ".concat(x," ")),o.a.createElement("span",null,"outbound"==y?"from":"repack"===y?"":"to"," "),o.a.createElement("span",{className:"green ".concat("repack"!==y?null:"d-none")}," ".concat("stockTransfer"===y?C:E||x," "))),o.a.createElement("p",{className:"text"},"Please double check this list, this record will store to database."),o.a.createElement("div",{style:{minHeight:k,maxHeight:k,overflow:"auto",border:"1px solid var(--lineGrey)"}},o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",{style:{borderBottom:"1px solid var(--lineGrey)"}},o.a.createElement("th",{style:{color:"var(--emptyTextField)"}},"SKU List"),o.a.createElement("th",{style:{textAlign:"right",color:"var(--emptyTextField)"}},"Weight"),o.a.createElement("th",{style:{textAlign:"right",color:"var(--emptyTextField)"}},"Semi Waste"),o.a.createElement("th",{style:{textAlign:"right",color:"var(--emptyTextField)"}},"Waste"))),o.a.createElement("tbody",null,null===D||void 0===D?void 0:D.map(e=>o.a.createElement("tr",{style:{borderBottom:"1px solid var(--lineGrey)"}},o.a.createElement("td",{style:{maxWidth:"160px"}},e.sku),o.a.createElement("td",{className:"text-right py-3",style:{textAlign:"right"}},"".concat(Object(r.B)(null===e||void 0===e?void 0:e.qty))),o.a.createElement("td",{className:"text-right text-nowrap",style:{textAlign:"right"}},o.a.createElement("span",{className:"text-nowrap"},"".concat(Object(r.B)(null===e||void 0===e?void 0:e.swqty)," "))),o.a.createElement("td",{className:"text-right",style:{textAlign:"right"}},"".concat(Object(r.B)(null===e||void 0===e?void 0:e.wqty)))))))),o.a.createElement("div",{className:"px-0 pb-5 pt-0 justify-content-start border-none"},o.a.createElement(n.d,{tabIndex:"0",onKeyDown:e=>13===e.keyCode&&c({show:!1,name:null}),className:"bg-background sku-item text no-shadow px-5 mt-4 mb-0 mx-0",onClick:()=>c({show:!1,name:null})},"Cancel"),o.a.createElement(n.d,{tabIndex:"0",onKeyDown:e=>13===e.keyCode&&(v?null:"save"===d.name?m():p()),className:"".concat(v?"bg-softGreen text":"bg-green text-white"," no-shadow px-5 mt-4 sku-item mb-0 ml-3 mr-0"),onClick:()=>v?null:"save"===d.name?m():p()},v?"Processing...":N)," ")))))},c=e=>{let{show:t=!1,setIsShowModal:a,submit:i,submitText:r="Submit"}=e;for(var d="",c="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",m=c.length,p=[],h=0;h<3;h++){let e=c.charAt(Math.floor(Math.random()*m));d+=e,p.push(e)}const v=Object(l.d)(e=>e.csvFileName),[b,w]=o.a.useState(p),[y,S]=o.a.useState(d),[g,k]=o.a.useState(!1),[N,f]=o.a.useState([]);return Object(s.useEffect)(()=>{!0===t&&(document.getElementById("t1").value="",document.getElementById("t2").value="",document.getElementById("t3").value="")},[t]),o.a.createElement(n.B,{className:t?null:"d-none"},o.a.createElement(n.f,null,o.a.createElement(n.s,{show:t,onClose:()=>{a(!1)},size:"lg",style:{height:"400px"}},o.a.createElement(n.v,{className:"px-5 pt-5 border-none"},o.a.createElement(n.w,{className:"text LatoBold"},"Confirmation")),o.a.createElement(n.t,{className:"px-5 py-0"},o.a.createElement("p",{className:"text mb-2"},"Are you sure want to upload ",o.a.createElement("span",{className:"green"},"Edited")," ",v,"?"),o.a.createElement("p",{className:"text"},"Once uploaded this record will store to databases."),o.a.createElement("p",{className:"text mb-2"},"Please type \u2018",y,"\u2019 on the Box to confirm upload file."),o.a.createElement("div",{className:"captcha-box"},o.a.createElement("input",{autocomplete:"off",onKeyUp:e=>{u({e:e,state:1,isCaptcha:b,setIsValidated:k,setIsType:f,isType:N,isValidated:g,submit:i})},id:"t1",type:"text",style:{textTransform:"uppercase"},className:"captcha-input",maxLength:"1",placeholder:b[0]}),o.a.createElement("input",{autocomplete:"off",onKeyUp:e=>{u({e:e,state:2,isCaptcha:b,setIsValidated:k,setIsType:f,isType:N,isValidated:g,submit:i})},id:"t2",type:"text",style:{textTransform:"uppercase"},className:"captcha-input ml-0 mr-0",maxLength:"1",placeholder:b[1]}),o.a.createElement("input",{autocomplete:"off",onKeyUp:e=>{u({e:e,state:3,isCaptcha:b,setIsValidated:k,setIsType:f,isType:N,isValidated:g,submit:i})},id:"t3",type:"text",style:{textTransform:"uppercase"},className:"captcha-input",maxLength:"1",placeholder:b[2]}))),o.a.createElement(n.u,{className:"px-5 pb-5 pt-0 justify-content-start border-none"},o.a.createElement(n.d,{className:"bg-background text no-shadow px-5 mt-4 mb-0 mx-0",onClick:()=>{a(!1)}},"Cancel"),o.a.createElement(n.d,{className:(g?"bg-green":"bg-emptyTextField disabled")+" no-shadow px-5 mt-4 mb-0 ml-3 mr-0",onClick:()=>{i(),k(!1)}},r)," "))))}},581:function(e,t,a){"use strict";a.d(t,"b",(function(){return p})),a.d(t,"a",(function(){return m}));var s=a(0),o=a.n(s),n=a(544),l=a(599),i=a.n(l),u=(a(582),a(600),a(56)),r=a.n(u),d=a(601),c=a.n(d);class m extends o.a.Component{constructor(e){var t;super(e),t=this,this.changeOutboundReason=e=>{setTimeout(()=>{let t=document.getElementById("row".concat(e,"-outboundReason"));t.classList.add("red","tooltip-custom"),t.innerHTML="Outbound Reason Can't be empty<span class=\"tooltiptext\">Outbound Reason Can't be empty if Outbound type = 'Lainnya'</span>"},300)},this.changeWarehouseUuid=(e,t,a,s,o,n,l)=>{const{setCsvDataTmp:i,globalData:u}=this.props;let r=u;var d=r.findIndex(e=>e.id==s);let c=o.indexOf(e);r[d][t]=n[c],r[d][a]=l[c],console.clear(),setTimeout(async()=>{i(r)},400)},this.validatePOSKU=async(e,t,a)=>{const{setCsvDataTmp:s,globalData:o,setIsValidate:n,transaction:l}=this.props;if("additional_inbound"==l)return;let i=o;try{n(!1);const o="/stocktake/rowValidationUpload";let l=null,u=null;setTimeout(async()=>{if(l=document.getElementById("".concat(a)),u=document.getElementById("".concat(a,"span")),null===l||void 0===l)return 0;u.innerHTML="Validating",l.classList.add("red"),await r()({method:"post",url:o,data:{data:[e]}}).then((function(e){var a;let o=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.data;var n=i.findIndex(e=>e.id==t);o[0]&&!0===o[0].isExist?(i[n].wmsPoSkuCode=o[0].wmsPoSkuCode,i[n].wmsPoSkuCodeStatus=!0,i[n].wmsPoSkuCodeReason="PO SKU Code Not Found",i[n].expiryDate=o[0].expiryDate,i[n].inboundDate=o[0].inboundDate,i[n].supplierName=o[0].supplierName,i[n].supplierUuid=o[0].supplierUuid,i[n].uom=o[0].uom,i[n].photos=o[0].photos,l.classList.remove("red"),l.classList.add("hiddenTooltip")):(i[n].wmsPoSkuCodeStatus=!1,i[n].wmsPoSkuCodeReason="PO SKU Code Not Found",i[n].expiryDate="",i[n].inboundDate="",i[n].supplierName="",i[n].supplierUuid="",l.classList.add("red"),l.classList.remove("hiddenTooltip"),u.innerHTML="PO SKU Code Not Found"),s(i)}))},400)}catch(u){return!1}},this.validatePOSKUStockTransfer=async(e,t,a,s)=>{const{setCsvDataTmp:o,globalData:n,setIsValidate:l,transaction:i}=this.props;let u=n;var d=u.findIndex(e=>e.id==t.id);try{const n="/stocktransfer/rowValidationUpload";let i=null,c=null,m=[{id:t.id,poSkuCode:"wmsPoSkuCode"==s?e:t.poSkuCode?t.poSkuCode:"",skuNumber:"skuNumber"==s?null===e||void 0===e?void 0:e.skuNumber:t.skuNumber,skuUuid:"skuNumber"==s?null===e||void 0===e?void 0:e.skuUuid:t.skuUuid,warehouseSource:t.warehouseSource,areaSource:t.areaSource,weight:"qty"==s?e:t.qty}];setTimeout(async()=>{if(l(!1),i=document.getElementById("".concat(a)),c=document.getElementById("".concat(a,"span")),null===i||void 0===i)return 0;c.innerHTML="Validating",await r()({method:"post",url:n,data:{data:m}}).then((function(t){var a;let n=null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.data;if(n[0]){var l,r,m,p,h,v,b,w,y,S,g;if(!0===n[0].isExist&&!0===n[0].isValid)u[d].rowStatus=!0,u[d].rowReason="",i.classList.remove("red"),i.classList.add("hiddenTooltip");else u[d].rowStatus=!1,u[d].rowReason=null===(g=n[0])||void 0===g?void 0:g.errorMessage;u[d].wmsPoSkuCode=null===(l=n[0])||void 0===l?void 0:l.wmsPoSkuCode,u[d].wmsPoSkuCodeStatus=(null===(r=n[0])||void 0===r?void 0:r.isExist)&&(null===(m=n[0])||void 0===m?void 0:m.isValid),u[d].wmsPoSkuCodeReason=null===(p=n[0])||void 0===p?void 0:p.errorMessage,u[d].expiryDate=null===(h=n[0])||void 0===h?void 0:h.expiryDate,u[d].inboundDate=null===(v=n[0])||void 0===v?void 0:v.inboundDate,u[d].supplierName=null===(b=n[0])||void 0===b?void 0:b.supplierName,u[d].supplierUuid=null===(w=n[0])||void 0===w?void 0:w.supplierUuid,u[d].uom=null===(y=n[0])||void 0===y?void 0:y.uom,u[d].photos=null===(S=n[0])||void 0===S?void 0:S.photos}else{var k,N,f;u[d].wmsPoSkuCodeStatus=!1,u[d].wmsPoSkuCodeReason=null===t||void 0===t||null===(k=t.data)||void 0===k?void 0:k.message,u[d].expiryDate="",u[d].inboundDate="",u[d].supplierName="",u[d].supplierUuid="",u[d].rowStatus=!1,u[d].rowReason=null===t||void 0===t||null===(N=t.data)||void 0===N?void 0:N.message,i.classList.add("red"),i.classList.remove("hiddenTooltip"),c.innerHTML=null===t||void 0===t||null===(f=t.data)||void 0===f?void 0:f.message}"skuNumber"==s&&(u[d].skuNumber=e.skuNumber,u[d].skuNumberReason=e.skuDescription,u[d].skuNumberStatus=!0,u[d].skuUuid=e.skuUuid),o(u)}));let t=this.state.keyy+1;this.setState({keyy:t})},500)}catch(c){return!1}},this.validateOutbountReason=(e,t,a)=>{const{globalData:s}=this.props;let o=s;var n=o.findIndex(e=>e.id==t);let l=o[n];""==e&&"LAINNYA"==l.outboundType.toUpperCase()&&this.changeOutboundReason(t)},this.validateOutbountType=(e,t,a)=>{const{globalData:s,setIsValidate:o}=this.props;let n=s;if(o(!1),"LAINNYA"!==e.toUpperCase())return o(!0),0;var l=n.findIndex(e=>e.id==t);""==n[l].outboundReason&&this.changeOutboundReason(t)},this.validateSKUNumber=async function(e,a,s,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const{globalData:l,setCsvDataTmp:i,setIsValidate:u,transaction:d}=t.props;let c=l;try{u(!1);const l="/oss/skuByNumbers";let m=null,p=null,h=!1,v={};setTimeout(async()=>{if(m=document.getElementById("".concat(s)),p=document.getElementById("".concat(s,"span")),null===m||void 0===m)return 0;p.innerHTML="Validating",await r()({method:"post",url:l,data:{skuList:[e]}}).then((function(t){var s;let n=null===t||void 0===t||null===(s=t.data)||void 0===s?void 0:s.data,l=t.data.isSuccess;var i=c.findIndex(e=>e.id==a);!0===l&&n.length>0?(h=!0,c[i][o]=n[0].skuNumber,c[i][o+"Reason"]=n[0].skuDescription,c[i][o+"Status"]=!0,c[i][o+"Uuid"]=n[0].id,v={skuUuid:n[0].id,skuNumber:n[0].skuNumber,skuDescription:n[0].skuDescription,photo:n[0].photo},"skuNumber"==o&&(c[i].skuUuid=n[0].id,c[i].photo=n[0].imageMd),"newGrade"==o&&(c[i].newGradeUom=n[0].uom),"additional_inbound"==d&&(c[i].uom=n[0].uom),"stockTransfer"!==d&&(m.classList.remove("red"),m.classList.add("hiddenTooltip"))):(h=!1,c[i][o]=e,c[i][o+"Reason"]="SKU Number Not Found",c[i][o+"Status"]=!1,c[i][o+"Uuid"]=null,m.classList.add("red"),m.classList.remove("hiddenTooltip"),p.innerHTML="SKU Number Not Found","skuNumber"==o&&(c[i].skuUuid="",c[i].photo=""),"newGrade"==o&&(c[i].newGradeUom=null),"additional_inbound"==d&&(c[i].uom=""))})),"stockTransfer"==d&&!0===h?t.validatePOSKUStockTransfer(v,n,s,"skuNumber"):i(c)},400)}catch(m){return!1}},this.state={validateStatus:!1,validateResult:"Please Wait...",globalData:this.props.globalData,rowCount:0,keyy:0,triggerRender:0},this.validatePOSKUStockTransfer=this.validatePOSKUStockTransfer.bind(this),this.validateSKUNumber=this.validateSKUNumber.bind(this)}render(){const{columns:e,hiddenRows:t,tableClass:a,warehouseArea:s,outboundType:l,setCheckingCsv:u,editable:r=!0,warehousesData:d=[],transaction:m,globalData:p}=this.props;let{validateStatus:h,keyy:v}=this.state,b=[],w=[],y=[];var S;d&&(null===d||void 0===d||null===(S=d.data)||void 0===S||S.map(e=>{b.push(e.code),w.push(e.id),y.push(e.name)}));let g=s.map(e=>e.label.toUpperCase())||[],k=s.map(e=>e.value)||[],N=l?l.map(e=>e.label.toUpperCase()):[],f=l?l.map(e=>e.value):[];const E=e.map((e,t)=>(e.validator=(t,a,s,o)=>{let n=e.dataField,l=n+"Status",i=n+"Reason",r=!0,d=null,c="row"+a.id+"-"+n;["wmsPoSkuCode","qty"].includes(n)&&"stockTransfer"==m?(this.validatePOSKUStockTransfer(t,a,c,n),r=!0):"wmsPoSkuCode"==n&&(this.validatePOSKU(t,a.id,c,n),r=!0),"skuNumber"==n&&(this.validateSKUNumber(t,a.id,c,n,a),r=!0);let p=["WASTE","SEMI WASTE"];if("newGrade"==n&&"waste"==this.props.transaction?p.includes(t.toUpperCase())?(a.newGradeUuid=t,a.newGradeUom=null):(d="Waste Type not found",h=!1,r=!1):"newGrade"==n&&(p.includes(t.toUpperCase())?(a.newGradeUuid=t,a.newGradeUom=null):parseInt(t)?(r=!0,this.validateSKUNumber(t,a.id,c,n)):""==t?(a.newGradeUuid=null,a.newGradeUom=null,r=!0):(d="Grade Undefined",h=!1,r=!1)),"outboundType"==n&&f.length>0)if(N.includes(t.toUpperCase())){let e=N.indexOf(t.toUpperCase());a.outboundTypeCode=f[e],r=!0,this.validateOutbountType(t,a.id,c)}else r=!1,d="Outbound Type Not Found";if("outboundReason"==n&&this.validateOutbountReason(t,a.id,c),"warehouse"==n&&(b.includes(t)?(r=!0,this.changeWarehouseUuid(t,"warehouseUuid","warehouseName",a.id,b,w,y)):(r=!1,d="Warehouse Not Found")),"warehouseDestination"==n&&(b.includes(t)?(r=!0,this.changeWarehouseUuid(t,"warehouseDestinationUuid","warehouseDestinationName",a.id,b,w,y)):(r=!1,d="Warehouse Not Found")),"areaName"==n||"areaNameDestination"==n)if(g.includes(t.toUpperCase())){let e=g.indexOf(t.toUpperCase());"areaNameDestination"==n?a.areaDestination=k[e]:a.areaSource=k[e],r=!0}else r=!1,d="Warehouse Area Not Found";if("newPack"==n){!isNaN(t)?r=!0:(r=!1,d="Pack Should be a number")}let h=null;h="number"!=e.type||!isNaN(t),!1===h&&(d="".concat(e.text," Should be a ").concat(e.type)),"wmsPoSkuCode"==n&&"stockTransfer"==m&&isNaN(t)&&(h=!1,d="".concat(e.text," Should be a number"),r=!1);if(["grade","outboundReason","ripenessLevel","newRipeness","reason","expiryDate"].includes(n)&&""===t?(d="",h=!0,r=!0):"grade"==n&&(p.includes(t.toUpperCase())||(d="Waste Type Not Found",h=!1,r=!1)),"ripenessLevel"==n||"newRipeness"==n){[0,1,2,3].includes(parseInt(t))||""==t?(h=!0,r=!0,d="",""==t&&(t="")):(h=!1,r=!1,d="Undefined Ripeness Level")}if("date_indo"==e.type){let e=/(0[1-9]|[12][0-9]|3[01])[-.](0[1-9]|1[012])[-.](19|20)\d\d/;t.match(e)||""==t?(h=!0,r=!0):(d="Date format must be 'dd-mm-yyyy'",h=!1,r=!1)}if(a[i]=d,r&&h){["wmsPoSkuCode","skuNumber"].includes(n)||(a[l]=!0,u())}return{valid:!(!r||!h),message:d}},e.formatter=(t,a,s)=>{let n=e.dataField,l=n+"Status",i=n+"Reason",u=!0,r="row"+a.id+"-"+n,d=a[i];return!1===a[l]?(h=!1,u=!1,o.a.createElement("div",{id:r,className:"tooltip-custom red"},t,o.a.createElement("span",{id:r+"span",className:"tooltiptext"},d))):"stockTransfer"==m&&!1===a.rowStatus?(h=!1,u=!1,o.a.createElement("div",{id:r,className:"tooltip-custom red"},t,o.a.createElement("span",{id:r+"span",className:"tooltiptext"},a.rowReason))):o.a.createElement("div",{id:r,className:"tooltip-custom hiddenTooltip"},t,o.a.createElement("span",{id:r+"span",className:"tooltiptext"},d))},e)),C={sortFunc:this.sortFunc,sortCaret:(e,t)=>e?"asc"===e?o.a.createElement("i",{className:"iconU-tableSortingTop ml-2"}):"desc"===e?o.a.createElement("i",{className:"iconU-tableSortingBottom ml-2"}):null:o.a.createElement("i",{className:"iconU-tableSortingNull ml-2"})};return console.clear(),console.log(p),o.a.createElement(n.e,{className:"table-responsive"},o.a.createElement(i.a,{keyField:"id",data:p,columns:E,sort:C,classes:a||null,cellEdit:!0===r?c()({mode:"click",blurToSave:!0,nonEditableRows:()=>this.props.dataDoubleRow||[]}):null,bordered:!1,hiddenRows:t,key:v}))}}class p extends o.a.Component{render(){const{columns:e,tableClass:t,data:a}=this.props,s=e.map((e,t)=>(e.formatter=(t,a,s)=>{let n=e.dataField;return"uploadStatus"==n&&"Failed"===a.uploadStatus?o.a.createElement("div",{className:"tooltip-custom red"},t,o.a.createElement("span",{className:"tooltiptext"},a.uploadStatusReason)):"uploadStatus"==n&&"Success"===a.uploadStatus?o.a.createElement("div",{className:"green"},t,o.a.createElement("span",null)):o.a.createElement("div",null,t,o.a.createElement("span",null))},e)),l={sortFunc:this.sortFunc,sortCaret:(e,t)=>e?"asc"===e?o.a.createElement("i",{className:"iconU-tableSortingTop ml-2"}):"desc"===e?o.a.createElement("i",{className:"iconU-tableSortingBottom ml-2"}):null:o.a.createElement("i",{className:"iconU-tableSortingNull ml-2"})};return o.a.createElement(n.e,{className:"table-responsive"},o.a.createElement(i.a,{keyField:"id",data:a,columns:s,sort:l,classes:t||null,bordered:!1}))}}},582:function(e,t,a){},631:function(e,t,a){}}]);
//# sourceMappingURL=52.c45cb463.chunk.js.map