(this["webpackJsonp@coreui/coreui-pro-react-admin-template"]=this["webpackJsonp@coreui/coreui-pro-react-admin-template"]||[]).push([[51],{1190:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),o=a(44),l=a(12),i=a(581),r=a(567),u=(a(630),a(16));a(549),a(14);var d=a(552);t.default=Object(l.i)(e=>{const t=Object(o.c)(),a=Object(o.d)(e=>e.csvFileName),l=Object(o.d)(e=>e.csvData),c=Object(o.d)(e=>e.csvField),m=Object(o.d)(e=>e.warehouseAreaCsv),p=Object(o.d)(e=>e.status),[v,b]=n.a.useState(!1),[h,y]=n.a.useState(null),[w,g]=n.a.useState(!0),[f,S]=n.a.useState(!1),[E,N]=n.a.useState(!1),[k,x]=n.a.useState(!0),[C,T]=n.a.useState(!1),[U,I]=n.a.useState(null),[D,O]=n.a.useState(null),[B,L]=n.a.useState(null),[P,R]=n.a.useState(null),[F,A]=n.a.useState(null),[W,j]=n.a.useState("Submit"),[K,V]=n.a.useState(null),[q,M]=n.a.useState(null);if(Object(s.useEffect)(()=>{(e=>{let{csvData:t,csvField:a,setIsValidate:s,setCheckingCsv:n}=e;if(void 0===t)return 0;let o=!0;t.map((e,t)=>{a.map((t,a)=>{!1===e[t.dataField+"Status"]&&(o=!1)})}),s(!1!==o),n(!1)})({csvData:l,csvField:c,setIsValidate:S,setCheckingCsv:x})},[k]),Object(s.useEffect)(()=>{},[l]),Object(s.useEffect)(()=>{"success"===C&&(A("Done"),R(""),O(a+" upload successfull. "),L("Would you import another file?"),I("Success"),V("bg-green background ml-0"),M("green"),N(!0))},[C]),void 0===l||null===l)return e.history.push("/inventory-entry/waste/CSV-upload"),0;const G=e=>{(e=>{let{param:t,dispatch:a,setCheckingCsv:s}=e;a({type:u.l,csvData:t}),s(!0)})({param:e,dispatch:t,setCheckingCsv:x})};return n.a.createElement("div",{className:"w-100 d-flex flex-column stock-take-summary"},n.a.createElement(i.a,{globalData:l,columns:c,tableClass:"reviewTable",hiddenRows:h,warehouseArea:m,setCsvDataTmp:e=>G(e),setIsValidate:e=>S(e),dispatch:t,setCheckingCsv:x,transaction:"waste"}),n.a.createElement("div",{className:"row pt-3"},n.a.createElement("div",{className:"col-4"}),n.a.createElement("div",{className:"col-4",style:{lineHeight:"40px"}},"Review your imported file: ",a," (",l.length||0," Lines)"),n.a.createElement("div",{className:"col-4"},n.a.createElement("button",{type:"button",className:"btn px-5 bg-red text-white no-shadow float-right",onClick:()=>e.history.goBack()},"Discard"),n.a.createElement("button",{type:"button",class:"btn px-5 mr-3 text-white no-shadow float-right bg-green",onClick:()=>b(!v)},"Submit"))),n.a.createElement(d.a,{status:p,onCloseFunction:()=>{N(!1),T(!1)},statusDisplay:E,title:U,cancelButtonTitle:P,actionButtonTitle:F,colorText:q,refreshOnCancel:!1,msg1:D,msg2:B,cancelButtonClass:null,actionButtonClass:K+" ml-0",actionButtonEvent:()=>e.history.push("/inventory-entry/waste/CSV-upload")}),n.a.createElement(r.a,{submit:()=>(async e=>{let{csvData:t,csvField:a,dispatch:s,selectorStatus:n,setIsShowModal:o,setIsSubmitText:l,setSubmitStatus:i}=e;l("Loading..."),console.clear(),o(!1),l("Submit"),i("success")})({dispatch:t,csvData:l,setIsShowModal:b,setIsSubmitText:j,setSubmitStatus:T,csvField:c}),submitText:W,show:v,setIsShowModal:b}))})},548:function(e,t,a){},551:function(e,t,a){},552:function(e,t,a){"use strict";var s=a(0),n=a.n(s),o=a(544);a(548);var l=a(44),i=a(16);t.a=e=>{let{refresh:t,status:a,icon:r,statusDisplay:u=!1,title:d="",cancelButtonTitle:c="Cancel",actionButtonTitle:m="Submit",cancelButtonClass:p="bg-background",actionButtonClass:v="bg-background",actionButtonEvent:b=null,colorText:h="red",msg1:y=null,msg2:w=null,onCloseFunction:g=null,refreshOnCancel:f=!0,setIsSuccess:S}=e;const E=Object(l.c)();500===(null===a||void 0===a?void 0:a.code)&&(r="em-pensive",d="Server Error",c="Try Again",m="Contact Administration",h="red",y=null===a||void 0===a?void 0:a.message,w="Please try again or contact Sayurbox administration for further information.",p="bg-green",u=!0,f=!0),408===(null===a||void 0===a?void 0:a.code)&&(r="em-alarm_clock",d="Request Timeout",c="Try Again",m="Contact Administration",h="red",y=null===a||void 0===a?void 0:a.message,w="Please try again or contact Sayurbox administration for further information.",p="bg-green",u=!0,f=!0),400===(null===a||void 0===a?void 0:a.code)&&(r="em-alarm_clock",d="Server Error",c="Try Again",m="Contact Administration",h="red",y=null===a||void 0===a?void 0:a.message,w="Please try again or contact Sayurbox administration for further information.",p="bg-green",u=!0,f=!1),404===(null===a||void 0===a?void 0:a.code)&&(d="Something wrong with the application",c="Try Again",m="Contact Administration",h="red",y=null===a||void 0===a?void 0:a.message,w="Please try again or contact Sayurbox administration for further information.",p="bg-green",u=!0,f=!1);const[N,k]=Object(s.useState)(u);return Object(s.useEffect)(()=>{k(u)},[u]),Object(s.useEffect)(()=>{},[N]),window.onkeydown=e=>27===e.keyCode?k(!1):null,n.a.createElement(o.B,{className:"".concat(N?null:"d-none")},n.a.createElement(o.f,null,n.a.createElement(o.s,{show:N,closeOnBackdrop:!1,onClose:()=>{k(!1),"function"===typeof S&&S({success:null,name:null}),E({type:i.k,status:null}),g&&g()},size:"lg",style:{minHeight:"280px"},bodyOpenClassName:"p-3"},n.a.createElement("div",{className:"d-flex flex-row-reverse"},n.a.createElement("i",{className:"pr-3 pt-3 iconU-modalClose",onClick:()=>{k(!1),"function"===typeof S&&S({success:null,name:null}),E({type:i.k,status:null}),g&&g()}})),n.a.createElement(o.v,{className:"px-5 pt-5 border-none"},n.a.createElement(o.w,{className:"text LatoBold ".concat(h)},d," ",n.a.createElement("span",null,n.a.createElement("i",{className:"em ".concat(r)})))),n.a.createElement(o.t,{className:"px-5 py-0"},n.a.createElement("p",{className:"text mb-2"},y),n.a.createElement("p",{className:"text"},w)),n.a.createElement(o.u,{className:"px-5 pb-5 pt-0 justify-content-start border-none"},c?n.a.createElement(o.d,{className:"".concat(p," no-shadow px-5 mt-4 mb-0 mx-0"),onClick:()=>{f?"function"===typeof t?t():(e=>{let{refresh:t=!0}=e;!0===t&&window.location.reload(!1)})({refresh:!0}):(e=>{let{setShow:t,parentOncCloseFunction:a}=e;t(!1),a&&a()})({setShow:k,parentOncCloseFunction:g}),E({type:i.k,status:null})}},c):null,m?n.a.createElement(o.d,{className:"".concat(v," text no-shadow px-5 mt-4 mb-0 ml-3 mr-0"),onClick:()=>{b?(b(),k(!1)):k(!1)}},m):null," "))))}},567:function(e,t,a){"use strict";a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return c}));var s=a(0),n=a.n(s),o=a(544),l=(a(551),a(44)),i=a(597);const r=e=>{let{e:t,state:a,isCaptcha:s,setIsValidated:n,setIsType:o,isType:l,isValidated:i,submit:r}=e;const u=t.key;let d=[...l];if("Enter"===u){if(!i)return;r()}if(["ArrowUp","ArrowDown","Tab","Delete"].includes(u))return 0;if("Backspace"===u){let e=[...l];""==e[a]&&1!==a&&(document.getElementById("t"+(parseInt(a)-1)).focus(),document.getElementById("t"+(parseInt(a)-1)).value="",e[a-1]="",d[a-1]="")}else if("ArrowLeft"===u){if(1!==a)return document.getElementById("t"+(parseInt(a)-1)).focus(),document.getElementById("t"+(parseInt(a)-1)).setSelectionRange(-1,-1),0}else if("ArrowRight"===u){if(3!==a)return document.getElementById("t"+(parseInt(a)+1)).focus(),document.getElementById("t"+(parseInt(a)+1)).setSelectionRange(-1,-1),0}else 3!==a&&document.getElementById("t"+(parseInt(a)+1)).focus();d[a]="Backspace"===u?"":u.toUpperCase();if(!"QWERTYUIOPLKJHGFDSAZXCVBNM1234567890".split("").includes(u.toUpperCase())&&""!=d[a])return 0;document.getElementById("t"+parseInt(a)).value=d[a],o(d);let c=!0;s.map((e,t)=>{d[t+1]!=s[t]&&(c=!1)}),n(c)};var u=a(547);const d=e=>{var t,a,l;let{moduleEntry:r,confirmation:d,setConfirmation:c,save:m,submit:p,isSuccess:v,isLoading:b,moveAll:h,setAction:y,moduleName:w,noSkuChecking:g,singleViewData:f}=e;const S=document.documentElement.clientHeight-300;let E="Submit";"save"===d.name&&(E="Save"),Object(s.useEffect)(()=>{v&&c({show:!1,name:null})},[v]),window.onkeydown=e=>27===e.keyCode?c({show:!1,name:null}):null,Object(s.useEffect)(()=>{y(d.name)},[d]);let N=f&&!h?f:r;const k=null===N||void 0===N||null===(t=N.jobPost)||void 0===t?void 0:t.areaDestinationName,x=null===N||void 0===N||null===(a=N.jobPost)||void 0===a?void 0:a.warehouseDestinationName,C=null===N||void 0===N||null===(l=N.jobPost)||void 0===l?void 0:l.areaName,T=((e,t,a)=>{if(null===e||void 0===e?void 0:e.length){let s=[];e.map(e=>{e.poList.map(n=>{n.itemList.map(n=>{var o,l,r,u,d,c;const{qty:m,grade:p}=n,v=Object(i.a)(m)?parseInt(m):m?parseFloat(m):0,b=t?e.skuName:"waste"===a?(null===(o=n.wasteType)||void 0===o?void 0:o.label)?null===(l=n.wasteType)||void 0===l?void 0:l.label:e.skuName:null===p||void 0===p?void 0:p.label,h="waste"===a?"Semi Waste"===(null===(r=n.wasteType)||void 0===r?void 0:r.label)||"Waste"===(null===(u=n.wasteType)||void 0===u?void 0:u.label):"Waste"===(null===p||void 0===p?void 0:p.label)||"Semi Waste"===(null===p||void 0===p?void 0:p.label),y=t?e.unitOfMeassures:"gram"===(null===p||void 0===p?void 0:p.uom)?"kg":null===p||void 0===p?void 0:p.uom;let w={sku:b,qty:v,uom:y,wqty:0,swqty:0};h&&(w.qty=0,w.sku=e.skuName),("waste"===a?"Waste"===(null===(d=n.wasteType)||void 0===d?void 0:d.label):"Waste"===(null===p||void 0===p?void 0:p.label))&&(w.wqty=v),("waste"===a?"Semi Waste"===(null===(c=n.wasteType)||void 0===c?void 0:c.label):"Semi Waste"===(null===p||void 0===p?void 0:p.label))&&(w.swqty=v);const g=s.findIndex(t=>(null===t||void 0===t?void 0:t.sku)===(h?e.skuName:b));var f,S;("waste"!==a&&(-1===g&&s.push(w),-1!==g&&(h||(s[g].qty+=v),"Semi Waste"===(null===p||void 0===p?void 0:p.label)&&(s[g].swqty+=v),"Waste"===(null===p||void 0===p?void 0:p.label)&&(s[g].wqty+=v))),"waste"===a)&&(-1===g&&s.push(w),-1!==g&&(h||(s[g].qty+=v),"Semi Waste"===(null===(f=n.wasteType)||void 0===f?void 0:f.label)&&(s[g].swqty+=v),"Waste"===(null===(S=n.wasteType)||void 0===S?void 0:S.label)&&(s[g].wqty+=v)))})})});const n=e.length?e[0].skuName:"No SKU",o=s.findIndex(e=>e.sku===n);return s.forEach(e=>{-1!==o&&("Waste"===e.sku&&(s[o].wqty=e.qty),"Semi Waste"===e.sku&&(s[o].swqty=e.qty))}),s}})(null===N||void 0===N?void 0:N.jobPost.list,g,w);return n.a.createElement(o.B,{className:"modalConfirmation "+(d.show?null:"d-none")},n.a.createElement(o.f,null,n.a.createElement(o.s,{show:d.show,closeOnBackdrop:!1},n.a.createElement(o.v,{className:"px-4 pt-5 border-none"},n.a.createElement(o.w,{className:"text LatoBold"},"Confirmation"," ",n.a.createElement("span",null,n.a.createElement("i",{className:"em em-pray"}))),n.a.createElement("label",{tabIndex:"0",onKeyDown:e=>13===e.keyCode&&c({show:!1,name:null}),onClick:()=>c({show:!1,name:null}),className:"sku-item iconU-modalClose"})),n.a.createElement(o.t,{className:"px-4 py-0",style:{minHeight:S}},n.a.createElement("p",{className:"text mb-2"},n.a.createElement("span",null,"Are you sure want to ".concat("Waste"==C?"update":"send"," this Item ")),n.a.createElement("span",{className:" ".concat(k?null:"d-none")}," from"),n.a.createElement("span",{className:"green ".concat(k?null:"d-none")}," ".concat(C," ")),n.a.createElement("span",null,"outbound"==w?"from":"repack"===w?"":"to"," "),n.a.createElement("span",{className:"green ".concat("repack"!==w?null:"d-none")}," ".concat("stockTransfer"===w?x:k||C," "))),n.a.createElement("p",{className:"text"},"Please double check this list, this record will store to database."),n.a.createElement("div",{style:{minHeight:S,maxHeight:S,overflow:"auto",border:"1px solid var(--lineGrey)"}},n.a.createElement("table",null,n.a.createElement("thead",null,n.a.createElement("tr",{style:{borderBottom:"1px solid var(--lineGrey)"}},n.a.createElement("th",{style:{color:"var(--emptyTextField)"}},"SKU List"),n.a.createElement("th",{style:{textAlign:"right",color:"var(--emptyTextField)"}},"Weight"),n.a.createElement("th",{style:{textAlign:"right",color:"var(--emptyTextField)"}},"Semi Waste"),n.a.createElement("th",{style:{textAlign:"right",color:"var(--emptyTextField)"}},"Waste"))),n.a.createElement("tbody",null,null===T||void 0===T?void 0:T.map(e=>n.a.createElement("tr",{style:{borderBottom:"1px solid var(--lineGrey)"}},n.a.createElement("td",{style:{maxWidth:"160px"}},e.sku),n.a.createElement("td",{className:"text-right py-3",style:{textAlign:"right"}},"".concat(Object(u.B)(null===e||void 0===e?void 0:e.qty))),n.a.createElement("td",{className:"text-right text-nowrap",style:{textAlign:"right"}},n.a.createElement("span",{className:"text-nowrap"},"".concat(Object(u.B)(null===e||void 0===e?void 0:e.swqty)," "))),n.a.createElement("td",{className:"text-right",style:{textAlign:"right"}},"".concat(Object(u.B)(null===e||void 0===e?void 0:e.wqty)))))))),n.a.createElement("div",{className:"px-0 pb-5 pt-0 justify-content-start border-none"},n.a.createElement(o.d,{tabIndex:"0",onKeyDown:e=>13===e.keyCode&&c({show:!1,name:null}),className:"bg-background sku-item text no-shadow px-5 mt-4 mb-0 mx-0",onClick:()=>c({show:!1,name:null})},"Cancel"),n.a.createElement(o.d,{tabIndex:"0",onKeyDown:e=>13===e.keyCode&&(b?null:"save"===d.name?m():p()),className:"".concat(b?"bg-softGreen text":"bg-green text-white"," no-shadow px-5 mt-4 sku-item mb-0 ml-3 mr-0"),onClick:()=>b?null:"save"===d.name?m():p()},b?"Processing...":E)," ")))))},c=e=>{let{show:t=!1,setIsShowModal:a,submit:i,submitText:u="Submit"}=e;for(var d="",c="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",m=c.length,p=[],v=0;v<3;v++){let e=c.charAt(Math.floor(Math.random()*m));d+=e,p.push(e)}const b=Object(l.d)(e=>e.csvFileName),[h,y]=n.a.useState(p),[w,g]=n.a.useState(d),[f,S]=n.a.useState(!1),[E,N]=n.a.useState([]);return Object(s.useEffect)(()=>{!0===t&&(document.getElementById("t1").value="",document.getElementById("t2").value="",document.getElementById("t3").value="")},[t]),n.a.createElement(o.B,{className:t?null:"d-none"},n.a.createElement(o.f,null,n.a.createElement(o.s,{show:t,onClose:()=>{a(!1)},size:"lg",style:{height:"400px"}},n.a.createElement(o.v,{className:"px-5 pt-5 border-none"},n.a.createElement(o.w,{className:"text LatoBold"},"Confirmation")),n.a.createElement(o.t,{className:"px-5 py-0"},n.a.createElement("p",{className:"text mb-2"},"Are you sure want to upload ",n.a.createElement("span",{className:"green"},"Edited")," ",b,"?"),n.a.createElement("p",{className:"text"},"Once uploaded this record will store to databases."),n.a.createElement("p",{className:"text mb-2"},"Please type \u2018",w,"\u2019 on the Box to confirm upload file."),n.a.createElement("div",{className:"captcha-box"},n.a.createElement("input",{autocomplete:"off",onKeyUp:e=>{r({e:e,state:1,isCaptcha:h,setIsValidated:S,setIsType:N,isType:E,isValidated:f,submit:i})},id:"t1",type:"text",style:{textTransform:"uppercase"},className:"captcha-input",maxLength:"1",placeholder:h[0]}),n.a.createElement("input",{autocomplete:"off",onKeyUp:e=>{r({e:e,state:2,isCaptcha:h,setIsValidated:S,setIsType:N,isType:E,isValidated:f,submit:i})},id:"t2",type:"text",style:{textTransform:"uppercase"},className:"captcha-input ml-0 mr-0",maxLength:"1",placeholder:h[1]}),n.a.createElement("input",{autocomplete:"off",onKeyUp:e=>{r({e:e,state:3,isCaptcha:h,setIsValidated:S,setIsType:N,isType:E,isValidated:f,submit:i})},id:"t3",type:"text",style:{textTransform:"uppercase"},className:"captcha-input",maxLength:"1",placeholder:h[2]}))),n.a.createElement(o.u,{className:"px-5 pb-5 pt-0 justify-content-start border-none"},n.a.createElement(o.d,{className:"bg-background text no-shadow px-5 mt-4 mb-0 mx-0",onClick:()=>{a(!1)}},"Cancel"),n.a.createElement(o.d,{className:(f?"bg-green":"bg-emptyTextField disabled")+" no-shadow px-5 mt-4 mb-0 ml-3 mr-0",onClick:()=>{i(),S(!1)}},u)," "))))}},581:function(e,t,a){"use strict";a.d(t,"b",(function(){return p})),a.d(t,"a",(function(){return m}));var s=a(0),n=a.n(s),o=a(544),l=a(599),i=a.n(l),r=(a(582),a(600),a(56)),u=a.n(r),d=a(601),c=a.n(d);class m extends n.a.Component{constructor(e){var t;super(e),t=this,this.changeOutboundReason=e=>{setTimeout(()=>{let t=document.getElementById("row".concat(e,"-outboundReason"));t.classList.add("red","tooltip-custom"),t.innerHTML="Outbound Reason Can't be empty<span class=\"tooltiptext\">Outbound Reason Can't be empty if Outbound type = 'Lainnya'</span>"},300)},this.changeWarehouseUuid=(e,t,a,s,n,o,l)=>{const{setCsvDataTmp:i,globalData:r}=this.props;let u=r;var d=u.findIndex(e=>e.id==s);let c=n.indexOf(e);u[d][t]=o[c],u[d][a]=l[c],console.clear(),setTimeout(async()=>{i(u)},400)},this.validatePOSKU=async(e,t,a)=>{const{setCsvDataTmp:s,globalData:n,setIsValidate:o,transaction:l}=this.props;if("additional_inbound"==l)return;let i=n;try{o(!1);const n="/stocktake/rowValidationUpload";let l=null,r=null;setTimeout(async()=>{if(l=document.getElementById("".concat(a)),r=document.getElementById("".concat(a,"span")),null===l||void 0===l)return 0;r.innerHTML="Validating",l.classList.add("red"),await u()({method:"post",url:n,data:{data:[e]}}).then((function(e){var a;let n=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.data;var o=i.findIndex(e=>e.id==t);n[0]&&!0===n[0].isExist?(i[o].wmsPoSkuCode=n[0].wmsPoSkuCode,i[o].wmsPoSkuCodeStatus=!0,i[o].wmsPoSkuCodeReason="PO SKU Code Not Found",i[o].expiryDate=n[0].expiryDate,i[o].inboundDate=n[0].inboundDate,i[o].supplierName=n[0].supplierName,i[o].supplierUuid=n[0].supplierUuid,i[o].uom=n[0].uom,i[o].photos=n[0].photos,l.classList.remove("red"),l.classList.add("hiddenTooltip")):(i[o].wmsPoSkuCodeStatus=!1,i[o].wmsPoSkuCodeReason="PO SKU Code Not Found",i[o].expiryDate="",i[o].inboundDate="",i[o].supplierName="",i[o].supplierUuid="",l.classList.add("red"),l.classList.remove("hiddenTooltip"),r.innerHTML="PO SKU Code Not Found"),s(i)}))},400)}catch(r){return!1}},this.validatePOSKUStockTransfer=async(e,t,a,s)=>{const{setCsvDataTmp:n,globalData:o,setIsValidate:l,transaction:i}=this.props;let r=o;var d=r.findIndex(e=>e.id==t.id);try{const o="/stocktransfer/rowValidationUpload";let i=null,c=null,m=[{id:t.id,poSkuCode:"wmsPoSkuCode"==s?e:t.poSkuCode?t.poSkuCode:"",skuNumber:"skuNumber"==s?null===e||void 0===e?void 0:e.skuNumber:t.skuNumber,skuUuid:"skuNumber"==s?null===e||void 0===e?void 0:e.skuUuid:t.skuUuid,warehouseSource:t.warehouseSource,areaSource:t.areaSource,weight:"qty"==s?e:t.qty}];setTimeout(async()=>{if(l(!1),i=document.getElementById("".concat(a)),c=document.getElementById("".concat(a,"span")),null===i||void 0===i)return 0;c.innerHTML="Validating",await u()({method:"post",url:o,data:{data:m}}).then((function(t){var a;let o=null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.data;if(o[0]){var l,u,m,p,v,b,h,y,w,g,f;if(!0===o[0].isExist&&!0===o[0].isValid)r[d].rowStatus=!0,r[d].rowReason="",i.classList.remove("red"),i.classList.add("hiddenTooltip");else r[d].rowStatus=!1,r[d].rowReason=null===(f=o[0])||void 0===f?void 0:f.errorMessage;r[d].wmsPoSkuCode=null===(l=o[0])||void 0===l?void 0:l.wmsPoSkuCode,r[d].wmsPoSkuCodeStatus=(null===(u=o[0])||void 0===u?void 0:u.isExist)&&(null===(m=o[0])||void 0===m?void 0:m.isValid),r[d].wmsPoSkuCodeReason=null===(p=o[0])||void 0===p?void 0:p.errorMessage,r[d].expiryDate=null===(v=o[0])||void 0===v?void 0:v.expiryDate,r[d].inboundDate=null===(b=o[0])||void 0===b?void 0:b.inboundDate,r[d].supplierName=null===(h=o[0])||void 0===h?void 0:h.supplierName,r[d].supplierUuid=null===(y=o[0])||void 0===y?void 0:y.supplierUuid,r[d].uom=null===(w=o[0])||void 0===w?void 0:w.uom,r[d].photos=null===(g=o[0])||void 0===g?void 0:g.photos}else{var S,E,N;r[d].wmsPoSkuCodeStatus=!1,r[d].wmsPoSkuCodeReason=null===t||void 0===t||null===(S=t.data)||void 0===S?void 0:S.message,r[d].expiryDate="",r[d].inboundDate="",r[d].supplierName="",r[d].supplierUuid="",r[d].rowStatus=!1,r[d].rowReason=null===t||void 0===t||null===(E=t.data)||void 0===E?void 0:E.message,i.classList.add("red"),i.classList.remove("hiddenTooltip"),c.innerHTML=null===t||void 0===t||null===(N=t.data)||void 0===N?void 0:N.message}"skuNumber"==s&&(r[d].skuNumber=e.skuNumber,r[d].skuNumberReason=e.skuDescription,r[d].skuNumberStatus=!0,r[d].skuUuid=e.skuUuid),n(r)}));let t=this.state.keyy+1;this.setState({keyy:t})},500)}catch(c){return!1}},this.validateOutbountReason=(e,t,a)=>{const{globalData:s}=this.props;let n=s;var o=n.findIndex(e=>e.id==t);let l=n[o];""==e&&"LAINNYA"==l.outboundType.toUpperCase()&&this.changeOutboundReason(t)},this.validateOutbountType=(e,t,a)=>{const{globalData:s,setIsValidate:n}=this.props;let o=s;if(n(!1),"LAINNYA"!==e.toUpperCase())return n(!0),0;var l=o.findIndex(e=>e.id==t);""==o[l].outboundReason&&this.changeOutboundReason(t)},this.validateSKUNumber=async function(e,a,s,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const{globalData:l,setCsvDataTmp:i,setIsValidate:r,transaction:d}=t.props;let c=l;try{r(!1);const l="/oss/skuByNumbers";let m=null,p=null,v=!1,b={};setTimeout(async()=>{if(m=document.getElementById("".concat(s)),p=document.getElementById("".concat(s,"span")),null===m||void 0===m)return 0;p.innerHTML="Validating",await u()({method:"post",url:l,data:{skuList:[e]}}).then((function(t){var s;let o=null===t||void 0===t||null===(s=t.data)||void 0===s?void 0:s.data,l=t.data.isSuccess;var i=c.findIndex(e=>e.id==a);!0===l&&o.length>0?(v=!0,c[i][n]=o[0].skuNumber,c[i][n+"Reason"]=o[0].skuDescription,c[i][n+"Status"]=!0,c[i][n+"Uuid"]=o[0].id,b={skuUuid:o[0].id,skuNumber:o[0].skuNumber,skuDescription:o[0].skuDescription,photo:o[0].photo},"skuNumber"==n&&(c[i].skuUuid=o[0].id,c[i].photo=o[0].imageMd),"newGrade"==n&&(c[i].newGradeUom=o[0].uom),"additional_inbound"==d&&(c[i].uom=o[0].uom),"stockTransfer"!==d&&(m.classList.remove("red"),m.classList.add("hiddenTooltip"))):(v=!1,c[i][n]=e,c[i][n+"Reason"]="SKU Number Not Found",c[i][n+"Status"]=!1,c[i][n+"Uuid"]=null,m.classList.add("red"),m.classList.remove("hiddenTooltip"),p.innerHTML="SKU Number Not Found","skuNumber"==n&&(c[i].skuUuid="",c[i].photo=""),"newGrade"==n&&(c[i].newGradeUom=null),"additional_inbound"==d&&(c[i].uom=""))})),"stockTransfer"==d&&!0===v?t.validatePOSKUStockTransfer(b,o,s,"skuNumber"):i(c)},400)}catch(m){return!1}},this.state={validateStatus:!1,validateResult:"Please Wait...",globalData:this.props.globalData,rowCount:0,keyy:0,triggerRender:0},this.validatePOSKUStockTransfer=this.validatePOSKUStockTransfer.bind(this),this.validateSKUNumber=this.validateSKUNumber.bind(this)}render(){const{columns:e,hiddenRows:t,tableClass:a,warehouseArea:s,outboundType:l,setCheckingCsv:r,editable:u=!0,warehousesData:d=[],transaction:m,globalData:p}=this.props;let{validateStatus:v,keyy:b}=this.state,h=[],y=[],w=[];var g;d&&(null===d||void 0===d||null===(g=d.data)||void 0===g||g.map(e=>{h.push(e.code),y.push(e.id),w.push(e.name)}));let f=s.map(e=>e.label.toUpperCase())||[],S=s.map(e=>e.value)||[],E=l?l.map(e=>e.label.toUpperCase()):[],N=l?l.map(e=>e.value):[];const k=e.map((e,t)=>(e.validator=(t,a,s,n)=>{let o=e.dataField,l=o+"Status",i=o+"Reason",u=!0,d=null,c="row"+a.id+"-"+o;["wmsPoSkuCode","qty"].includes(o)&&"stockTransfer"==m?(this.validatePOSKUStockTransfer(t,a,c,o),u=!0):"wmsPoSkuCode"==o&&(this.validatePOSKU(t,a.id,c,o),u=!0),"skuNumber"==o&&(this.validateSKUNumber(t,a.id,c,o,a),u=!0);let p=["WASTE","SEMI WASTE"];if("newGrade"==o&&"waste"==this.props.transaction?p.includes(t.toUpperCase())?(a.newGradeUuid=t,a.newGradeUom=null):(d="Waste Type not found",v=!1,u=!1):"newGrade"==o&&(p.includes(t.toUpperCase())?(a.newGradeUuid=t,a.newGradeUom=null):parseInt(t)?(u=!0,this.validateSKUNumber(t,a.id,c,o)):""==t?(a.newGradeUuid=null,a.newGradeUom=null,u=!0):(d="Grade Undefined",v=!1,u=!1)),"outboundType"==o&&N.length>0)if(E.includes(t.toUpperCase())){let e=E.indexOf(t.toUpperCase());a.outboundTypeCode=N[e],u=!0,this.validateOutbountType(t,a.id,c)}else u=!1,d="Outbound Type Not Found";if("outboundReason"==o&&this.validateOutbountReason(t,a.id,c),"warehouse"==o&&(h.includes(t)?(u=!0,this.changeWarehouseUuid(t,"warehouseUuid","warehouseName",a.id,h,y,w)):(u=!1,d="Warehouse Not Found")),"warehouseDestination"==o&&(h.includes(t)?(u=!0,this.changeWarehouseUuid(t,"warehouseDestinationUuid","warehouseDestinationName",a.id,h,y,w)):(u=!1,d="Warehouse Not Found")),"areaName"==o||"areaNameDestination"==o)if(f.includes(t.toUpperCase())){let e=f.indexOf(t.toUpperCase());"areaNameDestination"==o?a.areaDestination=S[e]:a.areaSource=S[e],u=!0}else u=!1,d="Warehouse Area Not Found";if("newPack"==o){!isNaN(t)?u=!0:(u=!1,d="Pack Should be a number")}let v=null;v="number"!=e.type||!isNaN(t),!1===v&&(d="".concat(e.text," Should be a ").concat(e.type)),"wmsPoSkuCode"==o&&"stockTransfer"==m&&isNaN(t)&&(v=!1,d="".concat(e.text," Should be a number"),u=!1);if(["grade","outboundReason","ripenessLevel","newRipeness","reason","expiryDate"].includes(o)&&""===t?(d="",v=!0,u=!0):"grade"==o&&(p.includes(t.toUpperCase())||(d="Waste Type Not Found",v=!1,u=!1)),"ripenessLevel"==o||"newRipeness"==o){[0,1,2,3].includes(parseInt(t))||""==t?(v=!0,u=!0,d="",""==t&&(t="")):(v=!1,u=!1,d="Undefined Ripeness Level")}if("date_indo"==e.type){let e=/(0[1-9]|[12][0-9]|3[01])[-.](0[1-9]|1[012])[-.](19|20)\d\d/;t.match(e)||""==t?(v=!0,u=!0):(d="Date format must be 'dd-mm-yyyy'",v=!1,u=!1)}if(a[i]=d,u&&v){["wmsPoSkuCode","skuNumber"].includes(o)||(a[l]=!0,r())}return{valid:!(!u||!v),message:d}},e.formatter=(t,a,s)=>{let o=e.dataField,l=o+"Status",i=o+"Reason",r=!0,u="row"+a.id+"-"+o,d=a[i];return!1===a[l]?(v=!1,r=!1,n.a.createElement("div",{id:u,className:"tooltip-custom red"},t,n.a.createElement("span",{id:u+"span",className:"tooltiptext"},d))):"stockTransfer"==m&&!1===a.rowStatus?(v=!1,r=!1,n.a.createElement("div",{id:u,className:"tooltip-custom red"},t,n.a.createElement("span",{id:u+"span",className:"tooltiptext"},a.rowReason))):n.a.createElement("div",{id:u,className:"tooltip-custom hiddenTooltip"},t,n.a.createElement("span",{id:u+"span",className:"tooltiptext"},d))},e)),x={sortFunc:this.sortFunc,sortCaret:(e,t)=>e?"asc"===e?n.a.createElement("i",{className:"iconU-tableSortingTop ml-2"}):"desc"===e?n.a.createElement("i",{className:"iconU-tableSortingBottom ml-2"}):null:n.a.createElement("i",{className:"iconU-tableSortingNull ml-2"})};return console.clear(),console.log(p),n.a.createElement(o.e,{className:"table-responsive"},n.a.createElement(i.a,{keyField:"id",data:p,columns:k,sort:x,classes:a||null,cellEdit:!0===u?c()({mode:"click",blurToSave:!0,nonEditableRows:()=>this.props.dataDoubleRow||[]}):null,bordered:!1,hiddenRows:t,key:b}))}}class p extends n.a.Component{render(){const{columns:e,tableClass:t,data:a}=this.props,s=e.map((e,t)=>(e.formatter=(t,a,s)=>{let o=e.dataField;return"uploadStatus"==o&&"Failed"===a.uploadStatus?n.a.createElement("div",{className:"tooltip-custom red"},t,n.a.createElement("span",{className:"tooltiptext"},a.uploadStatusReason)):"uploadStatus"==o&&"Success"===a.uploadStatus?n.a.createElement("div",{className:"green"},t,n.a.createElement("span",null)):n.a.createElement("div",null,t,n.a.createElement("span",null))},e)),l={sortFunc:this.sortFunc,sortCaret:(e,t)=>e?"asc"===e?n.a.createElement("i",{className:"iconU-tableSortingTop ml-2"}):"desc"===e?n.a.createElement("i",{className:"iconU-tableSortingBottom ml-2"}):null:n.a.createElement("i",{className:"iconU-tableSortingNull ml-2"})};return n.a.createElement(o.e,{className:"table-responsive"},n.a.createElement(i.a,{keyField:"id",data:a,columns:s,sort:l,classes:t||null,bordered:!1}))}}},582:function(e,t,a){},630:function(e,t,a){}}]);
//# sourceMappingURL=51.888a00af.chunk.js.map